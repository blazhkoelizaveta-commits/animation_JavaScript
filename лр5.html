<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; background: #eef2f7; }
    #field {
      width: 800px; height: 500px; margin: 20px auto; border: 3px solid #333;
      background: #fff; position: relative; overflow: hidden; border-radius: 8px;
    }
    #box {
      width: 100px; height: 100px; background: #4a90e2; position: absolute; top: 0; left: 0;
      border-radius: 8px;
      display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;
    }
    .controls { margin: 12px 0; }
    button { padding: 10px 18px; margin: 6px; font-size: 15px; cursor: pointer; border-radius: 6px; }
  </style>
</head>
<body>

  <h1>–ê–Ω—ñ–º–∞—Ü—ñ—è (JavaScript)</h1>

  <div id="field">
    <div id="box">BOX</div>
  </div>

  <div class="controls">
    <button id="moveLeft">–í–ª—ñ–≤–æ ‚óÄÔ∏è</button>
    <button id="moveRight">–í–ø—Ä–∞–≤–æ ‚ñ∂Ô∏è</button>
    <button id="moveUp">–í–≥–æ—Ä—É ‚¨ÜÔ∏è</button>
    <button id="moveDown">–í–Ω–∏–∑ ‚¨áÔ∏è</button>
    <button id="stop">–°—Ç–æ–ø ‚èπ</button>
    <button id="reset">–°–∫–∏–Ω—É—Ç–∏ üîÑ</button>
  </div>

  <script>
  (function () {
    const field = document.getElementById('field');
    const box = document.getElementById('box');
    const btnLeft = document.getElementById('moveLeft');
    const btnRight = document.getElementById('moveRight');
    const btnUp = document.getElementById('moveUp');
    const btnDown = document.getElementById('moveDown');
    const btnStop = document.getElementById('stop');
    const btnReset = document.getElementById('reset');

    if (!field || !box) {
      console.error('–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ field –∞–±–æ box. –ü–µ—Ä–µ–≤—ñ—Ä, —â–æ –≤ HTML —î –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ id="field" —Ç–∞ id="box".');
      return;
    }


    const fieldRect = field.getBoundingClientRect();
    const fieldWidth = Math.round(fieldRect.width);
    const fieldHeight = Math.round(fieldRect.height);

    const boxRect = box.getBoundingClientRect();
    const boxWidth = Math.round(boxRect.width);
    const boxHeight = Math.round(boxRect.height);

    let posX = 0;
    let posY = 0;

    let vx = 0;
    let vy = 0;

    // requestAnimationFrame id
    let rafId = null;

    const maxX = Math.max(0, fieldWidth - boxWidth);
    const maxY = Math.max(0, fieldHeight - boxHeight);

    function animate() {
      posX += vx;
      posY += vy;

      if (posX < 0) posX = 0;
      if (posY < 0) posY = 0;
      if (posX > maxX) posX = maxX;
      if (posY > maxY) posY = maxY;

      box.style.transform = `translate(${posX}px, ${posY}px)`;

      rafId = requestAnimationFrame(animate);
    }

    function startLoopIfNeeded() {
      if (rafId == null) rafId = requestAnimationFrame(animate);
    }

    function stopMovement() {
      vx = 0;
      vy = 0;
      if (rafId !== null) {
        cancelAnimationFrame(rafId);
        rafId = null;
      }
    }

    btnRight && btnRight.addEventListener('click', () => { vx = 3; vy = 0; startLoopIfNeeded(); });
    btnLeft  && btnLeft.addEventListener('click',  () => { vx = -3; vy = 0; startLoopIfNeeded(); });
    btnDown  && btnDown.addEventListener('click',  () => { vy = 3; vx = 0; startLoopIfNeeded(); });
    btnUp    && btnUp.addEventListener('click',    () => { vy = -3; vx = 0; startLoopIfNeeded(); });

    btnStop && btnStop.addEventListener('click', () => {
      stopMovement();
    });

    btnReset && btnReset.addEventListener('click', () => {
      stopMovement();
      posX = 0; posY = 0;
      box.style.transform = `translate(0px, 0px)`;
    });

    window.addEventListener('resize', () => {
      const fr = field.getBoundingClientRect();
      const br = box.getBoundingClientRect();
    });

    box.style.transform = `translate(${posX}px, ${posY}px)`;
  })();
  </script>

</body>
</html>
